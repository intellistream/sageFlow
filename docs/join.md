+ 按timestamp_和num分别设置一个上下界， 作为 window
+ left_record / right_record 存， 到达某个阈值/超时就丢掉前面的东西